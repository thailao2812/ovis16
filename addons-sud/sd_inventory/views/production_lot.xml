<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
		
		<record id="action_lock_stock_lot" model="ir.actions.server">
            <field name="name">Lock stack</field>
            <field name="model_id" ref="stock.model_stock_lot"/>
            <field name="binding_model_id" ref="stock.model_stock_lot"/>
            <field name="state">code</field>
            <field name="code">action = records.action_lock_stock_lot()</field>
        </record>
        <record id="action_unlock_stock_lot" model="ir.actions.server">
            <field name="name">Unlock stack</field>
            <field name="model_id" ref="stock.model_stock_lot"/>
            <field name="binding_model_id" ref="stock.model_stock_lot"/>
            <field name="state">code</field>
            <field name="code">action = records.action_unlock_stock_lot()</field>
        </record>
        
        
		<record id="search_product_lot_search_inherit_add_fields" model="ir.ui.view">
	        <field name="name">stock.production.lot.search.inherit.add.fields</field>
	        <field name="model">stock.lot</field>
	        <field name="inherit_id" ref="stock.search_product_lot_filter"/>
	        <field name="arch" type="xml">
	            <xpath expr="//field[@name='product_id']" position="after">
	            	<field name="warehouse_id"/>
	            	<field name="production_id"/>
	            	<filter name="filter_stack_empty" string="Stack Empty" domain="[('stack_empty', '=', True)]"/>
	            	<filter name="group_by_warehouse" string="Warehouse" domain="[]" context="{'group_by': 'warehouse_id'}"/>
	            </xpath>
	        </field>
	     </record>
	

		
		<record id="view_stock_production_lot_inherit_add_fields_view" model="ir.ui.view">
	        <field name="name">stock.production.lot.inherit.add.fields.views</field>
	        <field name="model">stock.lot</field>
	        <field name="inherit_id" ref="stock.view_production_lot_tree"/>
	        <field name="arch" type="xml">
				 <xpath expr="//field[@name='name']" position="before">
				 	<field name="warehouse_id" readonly="1"/>
				 	<field name="code"/>
				 	<field name="zone_id" readonly="1" domain="[('location_wip', '!=', True)]"/>
				 	<field name="production_id"/>
				 	<field name="districts_id" string="Source Goods" readonly="1"/>
				 	<field name="stack_type"/>
				 </xpath>
				 <xpath expr="//field[@name='product_id']" position="after">
				 	<field name="bag_qty" sum="bag_qty" readonly="1"/>
				 	<field name="init_qty" string="Net Weight" sum="init_qty" readonly="1"/>
                    <field name="remaining_qty" readonly="1" invisible="1"/>
				 </xpath>
	        </field>
		</record>
			
	    <record id="view_stock_production_lot_inherit_add_fields" model="ir.ui.view">
	        <field name="name">stock.production.lot.inherit.add.fields.form</field>
	        <field name="model">stock.lot</field>
	        <field name="inherit_id" ref="stock.view_production_lot_form" />
	        <field name="arch" type="xml">
				<xpath expr="//sheet" position="before">
					<header>
						<button name="compute_qty" string="Compute Qty" type ="object"/>

					</header>
				</xpath>
			
<!--			<xpath expr="//div[@name='button_box']" position="before">-->
<!--				<header>-->
<!--					<button name="compute_qty" string="Compute Qty" type ="object"/>-->
<!--					<button name="create_picking_adj" string="ADJ Stack" type ="object"/>-->
<!--				</header>-->
<!--			 	-->
<!--			 </xpath>-->
								
			
			<xpath expr="//field[@name='name']" position="attributes">
			 	<attribute name="readonly">1</attribute>
			 </xpath>
			 
				 
	        <xpath expr="//group[@name='main_group']" position="replace">
	        	<group name="main_group">
					<group>
						<field name="warehouse_id" readonly="1"/>
						<field name="code"/>
						<label for="stack_empty"/>
						<div class="o_row">
							<field name="stack_empty" readonly="1"/>
							<button name="create_picking_adj" string="Empty Stack" type ="object"/>
						</div>

	                    <field name="zone_id" readonly="1"/>
	                    <field name="districts_id" string="Source Goods" readonly="1"/>
	                    <field name="date" readonly="1"/>
						<field name="categ_id" readonly="1"/>
                        <field name="stack_type" readonly="0"/>
	                    <field name="active" readonly="1"/>
	                    <field name="reason_stack_empty"/>
	                </group>
	                <group>
						<field name="lock"/>
	                    <field name="init_qty" string="Net Weight" readonly="1"/>
	                    <field name="remaining_qty" readonly="1" invisible="1"/>
	                    <field name="product_qty" invisible="1" readonly="1"/>
	                    <field name="bag_qty" readonly="1"/>
	                    <field name="pledged" string="Bank of Pledge"/>
	                    <field name="product_id" readonly="1"/>
	                    <field name="product_change_id" />
						<field name="avg_deduction" readonly="1"/>
						
						<field name="init_invetory" readonly="1"/>
						<field name="init_invetory_qty" readonly="1"/>
						<field name="init_invetory_bags" readonly="1"/>
	                    <field name="stack_qty"  invisible="1"/>
	                    
					</group>
				</group>
	        </xpath>
	        <xpath expr="//page[@name='description']" position="before">
		        <page string="History Move" name="history_move">
	                <field name="move_line_ids" readonly="1">
						<tree>
							<field name="picking_id" readonly="1"/>
							<field name="product_id" readonly="1"/>
							<field name="product_uom_id" readonly="1"/>
							<field name="location_id" readonly="1"/>
							<field name="location_dest_id" readonly="1"/>
							<field name="date"/>
							<field name="bag_no" sum="bag_no"/>
							<field name="init_qty" sum="init_qty"/>
							<field name="qty_done" sum="qty_done"/>
							<field name="state"/>
						</tree>
	                </field>
	                
	            </page>
	            <page string="History Stack" name="stack_his_ids">
    				<field name="stack_his_ids">
						<tree>
							<field name="stack_id" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
			                    <field name="stack_ids" attrs="{'readonly': [('state', '!=', 'draft')]}" invisible="1"/>
			                	<field name="name" string="Product" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
			                    <field name="net_weight" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
			                    <field name="no_of_bag" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
			                	<field name="date_order" string="Date &amp; Time" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
			                	<field name="from_zone_id" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
			                	<field name="to_zone_id" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
			                	<field name="user_approve_id" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
			                    <field name="state" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
						</tree>
					</field>
    			</page>
	        </xpath>
	        </field>
	    </record>
	    
	    <record id="stock.action_production_lot_form" model="ir.actions.act_window">
        <field name="name">Stack</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">stock.lot</field>
        <field name="view_ids"
                   eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('stock.view_production_lot_tree')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('stock.view_production_lot_form')})]"/>
        <field name="search_view_id" ref="stock.search_product_lot_filter"/>
        <field name="context">{'search_default_group_by_product': 1, 'display_complete': True, 'default_company_id': allowed_company_ids[0]}</field>
        <field name="domain">[('product_id.hide_report','=',False)]</field>
        <field name="help" type="html">
          <p class="o_view_nocontent_smiling_face">
            Add a lot/serial number
          </p><p>
            Lots/Serial numbers help you tracking the path followed by your products.
            From their traceability report you will see the full history of their use, as well as their composition.
          </p>
        </field>
    </record>
		        


    </data>
</odoo>
