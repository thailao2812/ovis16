<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
    
    	<record id="view_stock_kcs_sucden_search" model="ir.ui.view">
            <field name="name">stock.kcs.sucden.search</field>
            <field name="model">stock.picking</field>
            <field name="arch" type="xml">
                <search string="KCS">
                	<field name="name" string="Picking"/>
                	<field name="warehouse_id"/>
                	<field name="districts_id" string="Nguồn Hàng"/>
	        		<field name="contract_no"/>
                    <field name="partner_id"/>
                    <field name="product_id"/>
                    <field name="origin"/>
                    <field name="production_id"/>
                    
                    <group expand="1" string="Filters">
                    	<filter name="filter_state_draft" domain="[('state_kcs','=','draft')]" string="KCS Draft"/>
                    	<filter name="filter_state_approved" domain="[('state_kcs','=','approved')]" string="KCS Approve"/>
                    	<filter name="filter_state_rejected" domain="[('state_kcs','=','rejected')]" string="KCS Rejected"/>
                	</group>
                	<group expand="1" string="Group By">
                    	<filter name ="group_by_picking_type_id" string="Type" domain="[]" context="{'group_by':'picking_type_id'}"/>
                    	<filter name ="group_by_warehouse_id" string="Warehouse" domain="[]" context="{'group_by':'warehouse_id'}"/>
                    	<filter name ="group_by_state_kcs" string="State" domain="[]" context="{'group_by':'state_kcs'}"/>
                    	<filter string="Nguồn hàng" name="group_by_districts_id" domain="[]" context="{'group_by':'districts_id'}"/>
                	</group>
               </search>
            </field>
        </record>
        
        
    	<record id="view_stock_kcs_tree" model="ir.ui.view">
            <field name="name">view.stock.kcs.tree</field>
            <field name="model">stock.picking</field>
            <field name="priority">100</field>
            <field name="arch" type="xml">
                <tree string="KCS" default_order="id desc"  decoration-danger="state_kcs == 'draft'" decoration-muted="state in ('approved','rejected')" >
                	<field name="name" />
                	<field name="production_id" string="Production Order" optional="show" />
                	<field name="zone_id"/>
					<field name="lot_id" optional="show" />
					<field name="warehouse_id" optional="show" />
                	<field name="date_kcs" string="QC Approve" optional="show" />
	        		<field name="districts_id" string="Nguồn Hàng" optional="show" />
	        		<field name="contract_no" optional="show" />
                	<field name="partner_id" string="Partner" optional="show" />
                	<field name="date_done" optional="show" />
                	<field name="product_id" optional="show" />
                	
                	<field name="packing_id" optional="show" />
	        		<field name="total_bag" sum="total_bag" optional="show" />
	        		
                	<field name="total_init_qty" optional="show"  invisible="0" string="Net Weight" sum="total_init_qty"/>
                	<field name="total_qty" optional="show"  string="Basis Weight" sum="total_qty"/>
                	<field name="state_kcs" optional="show" invisible="0"/>
                	<field name="note" optional="show"/>
                	<field name="state" invisible="1"/>
                	
                </tree>
            </field>
        </record>

		<record id="view_stock_kcs_purchase_tree" model="ir.ui.view">
            <field name="name">view_stock_kcs_purchase_tree</field>
            <field name="model">stock.picking</field>
            <field name="priority">100</field>
            <field name="arch" type="xml">
                <tree string="KCS" default_order="id desc"  decoration-danger="state_kcs == 'draft'" decoration-muted="state in ('approved','rejected')" >
                	<field name="description_name" />
                	<field name="name" />
<!--                	<field name="production_id" string="Production Order" optional="show" />-->
					<field name="lot_id" optional="show" />
					<field name="warehouse_id" optional="show" />
                	<field name="date_kcs" string="QC Approve" optional="show" />
	        		<field name="districts_id" string="Nguồn Hàng" optional="show" />
	        		<field name="contract_no" optional="hide" />
                	<field name="partner_id" string="Partner" optional="show" />
                	<field name="date_done" optional="show" />
                	<field name="product_id" optional="show" />

                	<field name="packing_id" optional="show" />
	        		<field name="total_bag" sum="total_bag" optional="show" />

                	<field name="total_init_qty" optional="show"  invisible="0" string="Net Weight" sum="total_init_qty"/>
                	<field name="total_qty" optional="show"  string="Basis Weight" sum="total_qty"/>
                	<field name="state_kcs" optional="show" invisible="0"/>
                	<field name="note" optional="hide"/>
                	<field name="state" invisible="1"/>
                </tree>
            </field>
        </record>
        
        <record id="view_stock_kcs_form" model="ir.ui.view">
            <field name="name">view.stock.kcs.form</field>
            <field name="model">stock.picking</field>
            <field name="priority">50</field>
            <field name="arch" type="xml">
                <form string="KCS">
	                <header>
	                	<button string="Load" name="btt_loads" type="object"  class="oe_highlight" attrs="{'invisible': [('state_kcs','!=','draft')]}"/>
	                	<button string="Approve" name="btt_approved" type="object" class="oe_highlight" attrs="{'invisible': [('state_kcs','!=','draft')]}"/>
	                	<button string="Reject" name="btt_reject" type="object" class="oe_highlight" 
	                		attrs="{'invisible': ['|',('state_kcs','!=','draft'),('picking_type_code','=','incoming')]}"/>
	                	<!-- button string="Set to Draft" name="btt_draft" type="object" class="oe_highlight" attrs="{'invisible': [('state_kcs','not in',('approved','reject'))]}"/ -->
	                	<field name="state_kcs" widget="statusbar" statusbar_visible="draft,approved,rejected"/>
	                </header>
	                <sheet>
	                    <div class="oe_title">
	                        <h1>
	                            <field name="name" readonly="1"/>
	                        </h1>
	                    </div>
	                    <group>
	                    	<group>
	                    		<field name="origin"/>
	                    		<field name="date_kcs"/>
	                    		<field name="product_id" readonly="1"/>
	                    		<field name="contract_no"/>
	                    		<field name="total_qty" readonly="1"/>
	                    		<field name="kcs_criterions_id" attrs="{'readonly': [('special','!=',True)]}"/>
	                    	</group>
	                    	<group>
								
								<field name="partner_id" readonly="1"/>
								<field name="picking_type_id" readonly="1"/>
								<field name="picking_type_code" invisible="1"/>
								<field name="production_id"/>
            					
								<field name="special" groups="sd_quality.group_kcs_manager"/>
								<!--
								<label for="change_product_id"/>
									<div name="change_product_id" class="o_row">
										<field name="change_product_id" readonly="0"/>
										<button name="btt_change_product" type="object" string="Change Product"/>
									</div>
								-->
									<field name="use_sample" attrs="{'readonly': [('state_kcs','!=','draft')]}"/>
								<field name="picking_type_code" invisible="1"/>
	                    		<field name="special" invisible="1"/>
								
							</group>
	                    	<newline/>
	                    </group>
	                    <group >
                    		<field name="note"/>
                    	</group>
	                    <notebook>
		                    <page string="KCS">
		                    	<field name="kcs_line">
		                    		<tree>
		                    			<field name="picking_id"/>
					                    <field name="product_id"/>
					                    <field name="criterions_id"/>
					                    <field name="product_uom"/>
					                    <field name="product_qty" sum="product_qty"/>
					                    <field name="deduction" readonly="1"/>
					                    <field name="qty_reached"/>
					                    <field name="basis_weight" sum="basis_weight"/>
					                    <field name="state"/>
		                    		</tree>
		                    	</field>
	                    	</page>	
	                    	<page string="Intake Quality Average" attrs="{'invisible': [('use_sample', '=', False)]}">
		                    	<field name="kcs_sample_ids" readonly="1"/>
		                   	</page>
                    	</notebook>
                    </sheet>
                 <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
                </form>
            </field>
        </record>
        
        <record id="action_stock_kcs" model="ir.actions.act_window">
            <field name="name">Quality Analysis</field>
            <field name="res_model">stock.picking</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="view_stock_kcs_sucden_search"/>
            <field name="domain">[('picking_type_id.code','in',('incoming','outgoing','transfer_in','production_in','production_out')),('state','not in',('draft','cancel')),('picking_type_id.kcs','!=',False),('picking_type_id.operation','!=','station'),('state_kcs','!=','waiting')]</field>
            <field name="help" type="html">
            
              <p class="oe_view_nocontent_create">
                Click to create an internal move request. 
              </p><p>
                Most operations are prepared automatically by OpenERP according
                to your preconfigured logistics rules, but you can also record
                manual stock movements.
              </p>
            </field>
        </record>
        
        <record model="ir.actions.act_window.view" id="action_stock_kcs_view">
            <field name="sequence" eval="1"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_stock_kcs_tree"/>
            <field name="act_window_id" ref="action_stock_kcs"/>
        </record>
        <record model="ir.actions.act_window.view" id="action_kcs_form">
            <field name="sequence" eval="2"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_stock_kcs_form"/>
            <field name="act_window_id" ref="action_stock_kcs"/>
        </record>
        
        
        <record id="action_stock_kcs_purs" model="ir.actions.act_window">
            <field name="name">Quality Analysis</field>
            <field name="res_model">stock.picking</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="view_stock_kcs_sucden_search"/>
            <field name="domain">[('picking_type_id.code','in',('incoming','outgoing','transfer_in','production_in','production_out')),('state','!=','draft'),('picking_type_id.kcs','!=',False),('picking_type_id.operation','=','station')]</field>
            <field name="help" type="html">
            
              <p class="oe_view_nocontent_create">
                Click to create an internal move request. 
              </p><p>
                Most operations are prepared automatically by OpenERP according
                to your preconfigured logistics rules, but you can also record
                manual stock movements.
              </p>
            </field>
        </record>
         <record model="ir.actions.act_window.view" id="action_stock_kcs_purchase_view">
            <field name="sequence" eval="1"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_stock_kcs_purchase_tree"/>
            <field name="act_window_id" ref="action_stock_kcs_purs"/>
        </record>
        <record model="ir.actions.act_window.view" id="action_stock_kcs_purchase_form">
            <field name="sequence" eval="2"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_stock_kcs_form"/>
            <field name="act_window_id" ref="action_stock_kcs_purs"/>
        </record>

		<record id="view_picking_tree_grp_good_tree_inherit_sd_quality" model="ir.ui.view">
            <field name="name">view_picking_tree_grp_good_tree_inherit_sd_quality</field>
            <field name="model">stock.picking</field>
            <field name="inherit_id" ref="sd_inventory.view_picking_tree_grp_good_tree"/>
            <field name="arch" type="xml">
				<xpath expr="//field[@name='state']" position="after">
	          	  <field name="state_kcs"/>
              </xpath>
              
			</field>
		</record>
    </data>
</odoo>