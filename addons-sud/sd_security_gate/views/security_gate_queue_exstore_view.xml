<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <!-- Security gate queue Ex-Store tree view create="false" -->
        <record id="view_security_gate_queue_exstore_tree" model="ir.ui.view">
            <field name="name">ned.security.gate.queue.exstore.tree</field>
            <field name="model">ned.security.gate.queue</field>
            <!-- <field name="groups_id" eval="[(4,ref('sd_traffic.group_traffic_user'))]"/> create="false" -->
            <field name="arch" type="xml">
                <tree decoration-muted="state in ('closed','reject')" decoration-info="state == 'draft'" decoration-danger="state == 'approved'" string="Security Gate Queue">
                    <field name="name"/>
                    <field name="license_plate" />
                    <field name="first_cont" />
                    <field name="last_cont" />
                    <field name="shipping_id"/>
                    <field name="arrivial_time" />
                    <field name="time_in" />
                    <field name="time_out" />
                    <field name="customer_id" string="Customer" />
                    <field name="parking_order" />
                    <field name="product_id"/>
                    <field name="packing_id"/>
                    <field name="remarks" />
                    <field name="security_id" />
                    <field name="warehouse_id" options="{'no_create': True, 'no_edit': True, 'no_create_edit':True}" />
                    <field name="state" />
                    <field name="issue_state" />
                </tree>
            </field>
        </record>

        <!-- Security gate queue Ex-Store form view -->
        <record id="view_security_gate_queue_exstore_form" model="ir.ui.view">
            <field name="name">ned.security.gate.queue.exstore.form</field>
            <field name="model">ned.security.gate.queue</field>
            <field name="arch" type="xml">
                <form string="Delivery Registration Ex-Store">
                    <header>
	                    <button name="button_logistics_confirm" type="object" states='draft' string="Logistics Confirm" class="oe_highlight" groups="base.user_root,sd_traffic.group_traffic_user"/>
	                    <button name="button_sec_confirm" type="object" states='logistics_confirm' string="Security Confirm" class="oe_highlight" groups="base.user_root,sd_security_gate.group_security_gate_queue_user"/>
                        <button name="button_approve" type="object" states='sec_confirm' string="Approved" class="oe_highlight" groups="base.user_root,sd_traffic.group_traffic_user"/>
                        <!-- <button name="button_approve" type="object" states='wh_approved' string="Approved" class="oe_highlight" groups="base.user_root,stock.group_stock_user,stock.group_stock_manager"/> -->
                        <!-- <button name="button_reject" states="qc_approved" string="Reject" type="object" 
                            confirm="Are you sure want to reject Queue?" groups="base.user_root,sd_quality.group_kcs_user,sd_quality.group_kcs_manager"/> -->
                        <!-- <button name="button_cancel" states="draft,pur_approved,qc_approved,approved" string="Cancel" type="object" 
                            confirm="Are you sure want to cancel Queue?" groups="base.user_root,sd_purchase_contract.group_purchase_contract_user,sd_quality.group_kcs_user"/> -->
                        <button name="print_security_gate" states="draft,logistics_confirm,sec_confirm,approved,closed" string="Print" type="object" 
                            groups="base.group_user"/>
                        <field name="state" widget="statusbar" statusbar_visible="draft,logistics_confirm,sec_confirm,approved,closed"/>
                    </header>

                    <sheet>
                    	<div class="oe_title">
	                        <h1>
	                            <field name="name"/>
	                        </h1>
	                    </div>
                        <group>
                            <group string="Truck Data">
                            	<field name="type_transfer" invisible ='1'/>
                            	<field name="warehouse_id" required = "1" options="{'no_create': True, 'no_edit': True, 'no_create_edit':True}" />
                                <field name="trucking_id" options="{'no_create': True, 'no_edit': True, 'no_create_edit':True}"/>
                                <field name="license_plate" />
                                <field name="first_cont" groups="base.user_root,sd_sale_contract.group_sales_contract_user" />
                                <field name="last_cont" groups="base.user_root,sd_sale_contract.group_sales_contract_user" />
                                <field name="driver_name"/>
                                <field name="picking_type_id" options="{'no_create': True, 'no_edit': True, 'no_create_edit':True}" invisible ='0'/>
                                
                                <label for="nvs_nls_id"/>
                                <div name="nvs_nls_id" class="o_row">
                                    <field name="nvs_nls_id" widget="many2many_tags" options="{'no_create': True, 'no_open': True}" class="oe_inline"
                                                domain="([('shipping_id','=',shipping_id)])"
                                                attrs="{'readonly': [('state','in', ['logistics_confirm','approved','closed','cancel'])]}"/>
                                    <button name="button_load_do_ps" string="Load DO/PS" type="object" icon="fa-truck" 
                                            states="draft,sec_confirm" class="btn-default" invisible="1"/>
                                </div>

                                <label for="delivery_id"/>
                                <div name="delivery_id" class="o_row">
                                    <field name="delivery_id" widget="many2many_tags"  options="{'no_create': True, 'no_open': True}" class="oe_inline"
                                            domain="([('shipping_id','=',shipping_id),
                                                    ('trucking_no','ilike',license_plate)])"
                                            attrs="{'readonly': [('state','in', ['logistics_confirm','approved','closed','cancel'])]}"/>
                                    <button name="button_create_do_ps" string="Create DO/PS" type="object" icon="fa-pencil-square-o" 
                                            states="draft,sec_confirm" class="btn-default"/> 
                                </div>
                            </group>
                            <group>
                                <field name="parking_order"/>
                                <field name="shipping_id" options="{'no_create': True, 'no_open': True, 'no_create_edit':True}" />
                                <field name="customer_id" required = "1" options="{'no_create': True, 'no_edit': True, 'no_create_edit':True}" groups="base.user_root,sd_sale_contract.group_sales_contract_user" />
                                <field name="supplier_id" required = "1" options="{'no_create': True, 'no_edit': True, 'no_create_edit':True}" invisible ='1' />
                                <field name="product_id" options="{'no_create': True, 'no_open': True, 'no_create_edit':True}" groups="base.user_root,sd_sale_contract.group_sales_contract_user" />
                                <field name="packing_id" options="{'no_create': True, 'no_open': True, 'no_create_edit':True}" groups="base.user_root,sd_sale_contract.group_sales_contract_user" />
                                <field name="arrivial_time" />
                                <field name="time_in"/>
                                <field name="time_out"/>
                                <field name="security_id" />
                                <field name="remarks" groups="base.user_root,sd_quality.group_kcs_user,sd_quality.group_kcs_manager,sd_purchase_contract.group_purchase_contract_user"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="Weight Bridge" name="weight_bridge">
                                <group>
                                    <group col="6">
                                        <field name="first_weight" />
                                        <field name="second_weight" />
                                        <field name="net_weight" style="font-weight: bold"/>
                                    </group>
                                    <group>
                                        <field name="estimated_bags" string="Bags Qty."/>
                                        <field name="tare_weight" />
                                    </group>
                                </group>
                                <div class="oe_clear"/>
                            </page>
                        </notebook>                        
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

         
         <!-- Security gate queue action -->
        <record model="ir.actions.act_window" id="action_security_gate_queue_exstore">
            <field name="name">Delivery Registration Ex-Store</field>
            <field name="res_model">ned.security.gate.queue</field>
            <!-- <field name="type">ir.actions.act_window</field> -->
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="ned_security_gate_queue_search"/>
            <field name="domain">[('type_transfer','=','queue-exstore')]</field>
            <field name="context">{'filter_by_company':True,'default_type_transfer':'queue-exstore','exstore': True}</field>
        </record>

        <record model="ir.actions.act_window.view" id="action_queue_exstore_view">
            <field name="sequence" eval="1"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_security_gate_queue_exstore_tree"/>
            <field name="act_window_id" ref="action_security_gate_queue_exstore"/>
        </record>
        
        <record model="ir.actions.act_window.view" id="action_queue_exstore_form">
            <field name="sequence" eval="2"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_security_gate_queue_exstore_form"/>
            <field name="act_window_id" ref="action_security_gate_queue_exstore"/>
        </record>

    </data>
</odoo>
